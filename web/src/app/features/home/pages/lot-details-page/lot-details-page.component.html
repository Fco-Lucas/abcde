@if(this.lote) {

  <div class="flex flex-col md:flex-row h-screen pt-16 w-screen overflow-x-hidden">
    <!-- left -->
    <div class="w-screen md:w-1/4 h-auto md:h-full px-6 md:px-4 pt-2 md:pt-6 pb-2 flex flex-col md:overflow-y-auto">

      <div class="w-full mb-3">
        <button matButton="filled" class="w-full" (click)="openDialogFilterImages()">
          <mat-icon>search</mat-icon>
          Filtrar imagens
        </button>
      </div>
      
      <div class="flex-grow">
        <app-images-list
          [lote]="this.lote"
          [filters]="this.currentFilters()"
          [currentPage]="this.currentPage()"
          [pageSize]="this.pageSize"
          (totalPagesChange)="onTotalPagesChange($event)"
          [selectedImageId]="this.selectedImageId()"
          (imageSelected)="onImageSelected($event)"
        ></app-images-list>
      </div>

      <div class="mt-4">
        <app-images-list-pagination
          [currentPage]="this.currentPage()"
          [totalPages]="this.totalPages()"
          (pageChange)="onPageChange($event)"
        ></app-images-list-pagination>
      </div>

    </div>

    <!-- Right -->
    <div class="w-screen md:w-3/4 h-auto md:h-full px-6 md:px-4 pt-0 md:p-6 pb-2 md:overflow-y-auto">

      @if (selectedImageDetails()) {
      <div class="flex flex-col md:flex-row md:justify-between w-full gap-5">

        <!-- Coluna da Imagem (ocupa 1/2 ou 2/3 da largura em desktop, largura total em mobile) -->
        <div class="flex-1"> <!-- flex-1 para crescer, w-1/2 ou w-2/3 para controlar largura -->
          <div class="flex items-center justify-center overflow-hidden">
            <img [src]="selectedImageDetails()!.url" [alt]="selectedImageDetails()!.matricula" class="w-full object-contain">
          </div>
        </div>

        <!-- Coluna das Tabs com as Questões (ocupa 1/2 ou 1/3 da largura em desktop, largura total em mobile) -->
         <mat-card>
            <mat-card-content>
              <mat-tab-group dynamicHeight>
                <!-- Tab para Questões 1 à 30 -->
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="font-bold text-lg">1 - 30</span>
                  </ng-template>
                  <!-- Grid para as questões desta aba -->
                  <div class="grid py-2" style="grid-template-columns: auto repeat(7, 1fr);">
                    <!-- Cabeçalho das Opções -->
                    <div class="col-span-1"></div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">A</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">B</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">C</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">D</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">E</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">W</div>
                    <div class="flex justify-center items-center font-bold text-lg me-1">Z</div>

                    <!-- Loop para Questões 1-30 -->
                    @for (question of selectedImageDetails()!.questions; track question.id; let i = $index) {
                      @if (question.number >= 1 && question.number <= 30) {
                        <p class="text-lg font-semibold flex items-center justify-end pr-2 py-1">{{ question.number | number: '2.0' }}</p>
                        <mat-radio-group
                          [formControl]="getAnswerFormControl(i)"
                          class="col-span-7 flex justify-around items-center"
                        >
                          <mat-radio-button value="A"></mat-radio-button>
                          <mat-radio-button value="B"></mat-radio-button>
                          <mat-radio-button value="C"></mat-radio-button>
                          <mat-radio-button value="D"></mat-radio-button>
                          <mat-radio-button value="E"></mat-radio-button>
                          <mat-radio-button value="W"></mat-radio-button>
                          <mat-radio-button value="Z"></mat-radio-button>
                        </mat-radio-group>
                      }
                    }
                  </div>
                </mat-tab>

                <!-- Tab para Questões 31 à 60 -->
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="font-bold text-lg">31 - 60</span>
                  </ng-template>
                  <div class="grid gap-x-2 gap-y-2 py-2" style="grid-template-columns: auto repeat(7, 1fr);">
                    <!-- Cabeçalho das Opções (repetir para cada tab) -->
                    <div class="col-span-1"></div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">A</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">B</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">C</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">D</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">E</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">W</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">Z</div>

                    <!-- Loop para Questões 31-60 -->
                    @for (question of selectedImageDetails()!.questions; track question.id; let i = $index) {
                      @if (question.number >= 31 && question.number <= 60) {
                        <p class="text-lg font-semibold flex items-center justify-end pr-2 py-1 text-gray-900">{{ question.number }}</p>
                        <mat-radio-group
                          [formControl]="getAnswerFormControl(i)"
                          class="col-span-7 flex justify-around items-center"
                        >
                          <mat-radio-button value="A"></mat-radio-button>
                          <mat-radio-button value="B"></mat-radio-button>
                          <mat-radio-button value="C"></mat-radio-button>
                          <mat-radio-button value="D"></mat-radio-button>
                          <mat-radio-button value="E"></mat-radio-button>
                          <mat-radio-button value="W"></mat-radio-button>
                          <mat-radio-button value="Z"></mat-radio-button>
                        </mat-radio-group>
                      }
                    }
                  </div>
                </mat-tab>

                <!-- Tab para Questões 61 à 90 -->
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="font-bold text-lg">61 - 90</span>
                  </ng-template>
                  <div class="grid gap-x-2 gap-y-2 py-2" style="grid-template-columns: auto repeat(7, 1fr);">
                    <!-- Cabeçalho das Opções (repetir para cada tab) -->
                    <div class="col-span-1"></div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">A</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">B</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">C</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">D</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">E</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">W</div>
                    <div class="flex justify-center items-center font-bold text-sm text-gray-700 me-1">Z</div>

                    <!-- Loop para Questões 61-90 -->
                    @for (question of selectedImageDetails()!.questions; track question.id; let i = $index) {
                      @if (question.number >= 61 && question.number <= 90) {
                        <p class="text-lg font-semibold flex items-center justify-end pr-2 py-1 text-gray-900">{{ question.number }}</p>
                        <mat-radio-group
                          [formControl]="getAnswerFormControl(i)"
                          class="col-span-7 flex justify-around items-center"
                        >
                          <mat-radio-button value="A"></mat-radio-button>
                          <mat-radio-button value="B"></mat-radio-button>
                          <mat-radio-button value="C"></mat-radio-button>
                          <mat-radio-button value="D"></mat-radio-button>
                          <mat-radio-button value="E"></mat-radio-button>
                          <mat-radio-button value="W"></mat-radio-button>
                          <mat-radio-button value="Z"></mat-radio-button>
                        </mat-radio-group>
                      }
                    }
                  </div>
                </mat-tab>
              </mat-tab-group>
            </mat-card-content>
            <mat-card-actions class="h-full">
              <button matButton="filled" class="w-full" (click)="saveAnswers()">Salvar Respostas</button>
            </mat-card-actions>
         </mat-card>
      </div>
      } @else {
        <div class="text-center text-gray-500 py-8">
          Selecione uma imagem na lista à esquerda para visualizar os detalhes.
        </div>
      }

    </div>
  </div>

}